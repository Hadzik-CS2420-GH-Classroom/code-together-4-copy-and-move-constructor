<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 750" font-family="Consolas, monospace" font-size="13">

  <!-- ==================== TITLE ==================== -->
  <text x="550" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#c62828">
    Shallow Copy Danger: Why the Default Copy Constructor is WRONG
  </text>
  <text x="550" y="50" text-anchor="middle" font-size="13" fill="#666">
    What would happen if the compiler generated a default (shallow) copy for FancyNameTag
  </text>

  <!-- ==================== STEP 1: After Shallow Copy (left third) ==================== -->
  <text x="175" y="82" text-anchor="middle" font-size="15" font-weight="bold" fill="#333">Step 1: After Shallow Copy</text>
  <text x="175" y="98" text-anchor="middle" font-size="10" fill="#888">Both pointers share the SAME Bio</text>

  <!-- Stack region (step 1) -->
  <rect x="20" y="110" width="195" height="340" rx="8" fill="#e8f0fe" stroke="#4285f4" stroke-width="1.5"/>
  <text x="30" y="130" font-size="12" font-weight="bold" fill="#4285f4">STACK</text>

  <!-- fOriginal box -->
  <rect x="32" y="140" width="170" height="130" rx="6" fill="#fff" stroke="#333" stroke-width="2"/>
  <text x="117" y="160" text-anchor="middle" font-weight="bold" font-size="13" fill="#333">fOriginal</text>

  <!-- id_ -->
  <rect x="42" y="168" width="150" height="24" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
  <text x="52" y="185" fill="#333" font-size="11">id_ =</text>
  <text x="92" y="185" font-weight="bold" font-size="11" fill="#e65100">1</text>

  <!-- company_ -->
  <rect x="42" y="196" width="150" height="34" rx="4" fill="#e3f2fd" stroke="#1565c0" stroke-width="1"/>
  <text x="52" y="213" fill="#333" font-size="11">company_ =</text>
  <text x="47" y="226" font-weight="bold" font-size="9" fill="#1565c0">"Weber State Univ."</text>

  <!-- bio_ pointer -->
  <rect x="42" y="234" width="150" height="24" rx="4" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1"/>
  <text x="52" y="251" fill="#333" font-size="11">bio_</text>
  <circle cx="180" cy="246" r="5" fill="#c62828"/>

  <!-- fCopied box -->
  <rect x="32" y="290" width="170" height="130" rx="6" fill="#fffde7" stroke="#f57f17" stroke-width="2.5"/>
  <text x="117" y="310" text-anchor="middle" font-weight="bold" font-size="13" fill="#f57f17">fCopied</text>

  <!-- id_ (copied) -->
  <rect x="42" y="318" width="150" height="24" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
  <text x="52" y="335" fill="#333" font-size="11">id_ =</text>
  <text x="92" y="335" font-weight="bold" font-size="11" fill="#e65100">1</text>

  <!-- company_ (copied) -->
  <rect x="42" y="346" width="150" height="34" rx="4" fill="#e3f2fd" stroke="#1565c0" stroke-width="1.5"/>
  <text x="52" y="363" fill="#333" font-size="11">company_ =</text>
  <text x="47" y="376" font-weight="bold" font-size="9" fill="#1565c0">"Weber State Univ."</text>

  <!-- bio_ pointer (copied — SAME address!) -->
  <rect x="42" y="384" width="150" height="24" rx="4" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="52" y="401" fill="#333" font-size="11">bio_</text>
  <circle cx="180" cy="396" r="5" fill="#c62828"/>

  <!-- Heap region (step 1) -->
  <rect x="240" y="110" width="120" height="220" rx="8" fill="#e8f8e8" stroke="#2e7d32" stroke-width="1.5"/>
  <text x="250" y="130" font-size="12" font-weight="bold" fill="#2e7d32">HEAP</text>

  <!-- Single Bio block -->
  <rect x="250" y="140" width="100" height="120" rx="6" fill="#c8e6c9" stroke="#2e7d32" stroke-width="1.5"/>
  <text x="300" y="160" text-anchor="middle" font-weight="bold" font-size="11" fill="#1b5e20">Bio</text>

  <text x="258" y="178" fill="#333" font-size="9">name="Scott"</text>
  <text x="258" y="192" fill="#333" font-size="9">title="Prof"</text>
  <text x="258" y="206" fill="#333" font-size="9">dept="CS"</text>
  <text x="258" y="220" fill="#333" font-size="9">year=2010</text>

  <text x="300" y="275" text-anchor="middle" font-size="9" fill="#2e7d32">addr: aaa11</text>

  <!-- Arrow: fOriginal.bio_ -> Bio -->
  <line x1="185" y1="246" x2="248" y2="200" stroke="#c62828" stroke-width="2" marker-end="url(#arrowRed)"/>

  <!-- Arrow: fCopied.bio_ -> SAME Bio -->
  <line x1="185" y1="396" x2="248" y2="230" stroke="#c62828" stroke-width="2" marker-end="url(#arrowRed)"/>

  <!-- Danger label -->
  <rect x="225" y="340" width="150" height="45" rx="6" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="300" y="358" text-anchor="middle" font-size="11" font-weight="bold" fill="#c62828">SAME pointer!</text>
  <text x="300" y="375" text-anchor="middle" font-size="10" fill="#c62828">Only ONE Bio exists</text>

  <!-- ==================== STEP 2: fCopied destroyed (middle third) ==================== -->
  <text x="560" y="82" text-anchor="middle" font-size="15" font-weight="bold" fill="#333">Step 2: fCopied Destroyed</text>
  <text x="560" y="98" text-anchor="middle" font-size="10" fill="#888">~FancyNameTag() calls delete bio_</text>

  <!-- Stack region (step 2) -->
  <rect x="400" y="110" width="195" height="340" rx="8" fill="#e8f0fe" stroke="#4285f4" stroke-width="1.5"/>
  <text x="410" y="130" font-size="12" font-weight="bold" fill="#4285f4">STACK</text>

  <!-- fOriginal box (still alive, doesn't know Bio is gone) -->
  <rect x="412" y="140" width="170" height="130" rx="6" fill="#fff" stroke="#333" stroke-width="2"/>
  <text x="497" y="160" text-anchor="middle" font-weight="bold" font-size="13" fill="#333">fOriginal</text>

  <!-- id_ -->
  <rect x="422" y="168" width="150" height="24" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
  <text x="432" y="185" fill="#333" font-size="11">id_ =</text>
  <text x="472" y="185" font-weight="bold" font-size="11" fill="#e65100">1</text>

  <!-- company_ -->
  <rect x="422" y="196" width="150" height="34" rx="4" fill="#e3f2fd" stroke="#1565c0" stroke-width="1"/>
  <text x="432" y="213" fill="#333" font-size="11">company_ =</text>
  <text x="427" y="226" font-weight="bold" font-size="9" fill="#1565c0">"Weber State Univ."</text>

  <!-- bio_ pointer (DANGLING!) -->
  <rect x="422" y="234" width="150" height="24" rx="4" fill="#ffebee" stroke="#c62828" stroke-width="2.5"/>
  <text x="432" y="251" fill="#c62828" font-size="11" font-weight="bold">bio_</text>
  <circle cx="560" cy="246" r="5" fill="#c62828"/>

  <!-- fCopied box (destroyed — grayed/dashed) -->
  <rect x="412" y="290" width="170" height="130" rx="6" fill="#f5f5f5" stroke="#999" stroke-width="1.5" stroke-dasharray="6,3"/>
  <text x="497" y="350" text-anchor="middle" font-size="12" fill="#999">fCopied</text>
  <text x="497" y="368" text-anchor="middle" font-size="11" fill="#999">destroyed</text>

  <!-- Big X over fCopied -->
  <line x1="420" y1="298" x2="574" y2="412" stroke="#c62828" stroke-width="3" opacity="0.5"/>
  <line x1="574" y1="298" x2="420" y2="412" stroke="#c62828" stroke-width="3" opacity="0.5"/>

  <!-- delete label -->
  <text x="497" y="440" text-anchor="middle" font-size="10" font-weight="bold" fill="#c62828">~FancyNameTag()</text>
  <text x="497" y="452" text-anchor="middle" font-size="10" fill="#c62828">called delete bio_</text>

  <!-- Heap region (step 2) — Bio is FREED -->
  <rect x="620" y="110" width="120" height="220" rx="8" fill="#ffebee" stroke="#c62828" stroke-width="1.5"/>
  <text x="630" y="130" font-size="12" font-weight="bold" fill="#c62828">HEAP</text>

  <!-- Freed Bio block (strikethrough / dashed) -->
  <rect x="630" y="140" width="100" height="120" rx="6" fill="#ffcdd2" stroke="#c62828" stroke-width="2" stroke-dasharray="6,3"/>
  <text x="680" y="190" text-anchor="middle" font-weight="bold" font-size="14" fill="#c62828">FREED</text>
  <text x="680" y="210" text-anchor="middle" font-size="10" fill="#c62828">memory</text>

  <!-- Big X over freed Bio -->
  <line x1="635" y1="145" x2="725" y2="255" stroke="#c62828" stroke-width="3" opacity="0.4"/>
  <line x1="725" y1="145" x2="635" y2="255" stroke="#c62828" stroke-width="3" opacity="0.4"/>

  <text x="680" y="275" text-anchor="middle" font-size="9" fill="#c62828">addr: aaa11</text>

  <!-- Arrow: fOriginal.bio_ -> freed Bio (dangling!) -->
  <line x1="565" y1="246" x2="628" y2="200" stroke="#c62828" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>

  <!-- Dangling pointer label -->
  <rect x="608" y="340" width="145" height="45" rx="6" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="680" y="358" text-anchor="middle" font-size="11" font-weight="bold" fill="#c62828">DANGLING</text>
  <text x="680" y="375" text-anchor="middle" font-size="11" font-weight="bold" fill="#c62828">POINTER!</text>

  <!-- ==================== STEP 3: Crash (right third) ==================== -->
  <text x="920" y="82" text-anchor="middle" font-size="15" font-weight="bold" fill="#c62828">Step 3: CRASH!</text>
  <text x="920" y="98" text-anchor="middle" font-size="10" fill="#888">fOriginal tries to use or delete bio_</text>

  <!-- Stack region (step 3) -->
  <rect x="780" y="110" width="195" height="195" rx="8" fill="#e8f0fe" stroke="#4285f4" stroke-width="1.5"/>
  <text x="790" y="130" font-size="12" font-weight="bold" fill="#4285f4">STACK</text>

  <!-- fOriginal box (about to crash) -->
  <rect x="792" y="140" width="170" height="130" rx="6" fill="#ffebee" stroke="#c62828" stroke-width="2.5"/>
  <text x="877" y="160" text-anchor="middle" font-weight="bold" font-size="13" fill="#c62828">fOriginal</text>

  <!-- id_ -->
  <rect x="802" y="168" width="150" height="24" rx="4" fill="#fff3e0" stroke="#e65100" stroke-width="1"/>
  <text x="812" y="185" fill="#333" font-size="11">id_ =</text>
  <text x="852" y="185" font-weight="bold" font-size="11" fill="#e65100">1</text>

  <!-- company_ -->
  <rect x="802" y="196" width="150" height="34" rx="4" fill="#e3f2fd" stroke="#1565c0" stroke-width="1"/>
  <text x="812" y="213" fill="#333" font-size="11">company_ =</text>
  <text x="807" y="226" font-weight="bold" font-size="9" fill="#1565c0">"Weber State Univ."</text>

  <!-- bio_ pointer (dangling) -->
  <rect x="802" y="234" width="150" height="24" rx="4" fill="#ffebee" stroke="#c62828" stroke-width="2.5"/>
  <text x="812" y="251" fill="#c62828" font-size="11" font-weight="bold">bio_ -> ???</text>

  <!-- Heap region (step 3) — nothing valid -->
  <rect x="1000" y="110" width="80" height="195" rx="8" fill="#ffebee" stroke="#c62828" stroke-width="1.5"/>
  <text x="1010" y="130" font-size="12" font-weight="bold" fill="#c62828">HEAP</text>

  <!-- Question marks where Bio used to be -->
  <text x="1040" y="195" text-anchor="middle" font-size="36" font-weight="bold" fill="#c62828">?</text>
  <text x="1040" y="230" text-anchor="middle" font-size="10" fill="#c62828">invalid</text>
  <text x="1040" y="244" text-anchor="middle" font-size="10" fill="#c62828">memory</text>

  <!-- Arrow to invalid memory -->
  <line x1="952" y1="246" x2="998" y2="210" stroke="#c62828" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowRed)"/>

  <!-- Crash scenarios -->
  <rect x="780" y="325" width="300" height="125" rx="6" fill="#ffebee" stroke="#c62828" stroke-width="2"/>
  <text x="930" y="347" text-anchor="middle" font-size="12" font-weight="bold" fill="#c62828">What could happen:</text>

  <text x="795" y="368" fill="#c62828" font-size="11">1. fOriginal reads bio_</text>
  <text x="810" y="384" fill="#666" font-size="10">-> garbage data or crash</text>

  <text x="795" y="404" fill="#c62828" font-size="11">2. ~fOriginal() deletes bio_</text>
  <text x="810" y="420" fill="#666" font-size="10">-> double free (undefined behavior!)</text>

  <text x="795" y="440" fill="#c62828" font-size="11">3. Another object uses that memory</text>
  <text x="810" y="456" fill="#666" font-size="10">-> silent data corruption</text>

  <!-- ==================== BOTTOM CALLOUT BOXES ==================== -->

  <!-- The problem explained -->
  <rect x="20" y="490" width="540" height="100" rx="6" fill="#ffebee" stroke="#c62828" stroke-width="1.5"/>
  <text x="290" y="512" text-anchor="middle" font-size="12" font-weight="bold" fill="#c62828">The Problem: Shallow Copy (Default Behavior)</text>
  <text x="290" y="532" text-anchor="middle" font-size="11" fill="#666">The default copy constructor copies each member byte-for-byte.</text>
  <text x="290" y="548" text-anchor="middle" font-size="11" fill="#666">For bio_ (a pointer), it copies the ADDRESS, not the data it points to.</text>
  <text x="290" y="564" text-anchor="middle" font-size="11" fill="#666">Result: two objects think they own the same heap memory.</text>
  <text x="290" y="580" text-anchor="middle" font-size="11" fill="#c62828">The first destructor frees it; the second destructor crashes.</text>

  <!-- The solution -->
  <rect x="580" y="490" width="500" height="100" rx="6" fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.5"/>
  <text x="830" y="512" text-anchor="middle" font-size="12" font-weight="bold" fill="#2e7d32">The Fix: Deep Copy (Custom Copy Constructor)</text>
  <text x="830" y="532" text-anchor="middle" font-size="11" fill="#666">Write a custom copy constructor that allocates NEW heap memory:</text>
  <text x="830" y="552" text-anchor="middle" font-size="12" font-weight="bold" fill="#333">bio_ = new Bio(*other.bio_);</text>
  <text x="830" y="572" text-anchor="middle" font-size="11" fill="#666">Now each object owns its own Bio on the heap.</text>
  <text x="830" y="588" text-anchor="middle" font-size="11" fill="#2e7d32">Destructors can safely delete their own copy. No dangling pointers!</text>

  <!-- Rule of Five reminder -->
  <rect x="20" y="605" width="1060" height="55" rx="6" fill="#fff3e0" stroke="#e65100" stroke-width="1.5"/>
  <text x="550" y="626" text-anchor="middle" font-size="12" font-weight="bold" fill="#e65100">Rule of Five: If you write ANY of these, you probably need ALL of them</text>
  <text x="550" y="646" text-anchor="middle" font-size="11" fill="#666">Destructor  |  Copy Constructor  |  Copy Assignment  |  Move Constructor  |  Move Assignment</text>

  <!-- Visual timeline arrow across the bottom -->
  <line x1="100" y1="690" x2="1000" y2="690" stroke="#888" stroke-width="2" marker-end="url(#arrowGray)"/>
  <text x="175" y="715" text-anchor="middle" font-size="11" fill="#2e7d32">Looks fine...</text>
  <text x="560" y="715" text-anchor="middle" font-size="11" fill="#e65100">Trouble brewing...</text>
  <text x="920" y="715" text-anchor="middle" font-size="11" font-weight="bold" fill="#c62828">UNDEFINED BEHAVIOR!</text>

  <!-- Step circles on timeline -->
  <circle cx="175" cy="690" r="12" fill="#2e7d32"/>
  <text x="175" y="694" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">1</text>
  <circle cx="560" cy="690" r="12" fill="#e65100"/>
  <text x="560" y="694" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">2</text>
  <circle cx="920" cy="690" r="12" fill="#c62828"/>
  <text x="920" y="694" text-anchor="middle" font-size="10" font-weight="bold" fill="#fff">3</text>

  <!-- ==================== ARROW MARKERS ==================== -->
  <defs>
    <marker id="arrowRed" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#c62828"/>
    </marker>
    <marker id="arrowGray" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#888"/>
    </marker>
  </defs>

</svg>
